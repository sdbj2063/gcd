# Getting and Cleaning Data Course
-------------------------------------

### Presented by Johns Hopkins University through Coursera
November 2014

# Code Book for Course Project
----------------------------
Written by GitHub user sdbj2063. Copyright © 2014 sdbj2063. All Rights Reserved.

### Table of Contents
-------------------

I.	Introduction	3

II.	Documentation Conventions	3

III.	Assumptions about the Audience	3

IV.	Project Requirements	3

    1.	List of Deliverables:	3
    2.	Data Analysis Requirements:	4
    
V.	Original Data Sources	4

    1.	URLs	4
    2.	Licensing Statement from Original Development Team	5
    3.	Description of Data from the Original Project	5
    4.	Description of Data Sets	5
    5.	How Data Knits Together	6
    6.	Data Files Used with Definitions	6
    
VI.	Processing Decisions	6

    1.	R Language Libraries	7
    2.	Choosing Variables for Mean and Standard Deviation Calculations	7
    3.	Excluded Variables with “mean” in the Name	7
    4.	Background on Gyroscopes, Accelerometers and Original Data	8
    5.	Human-readable Variable Names	9
    6.	Variable Key Words and Their Meanings	9
    7.	List of mean() variables used with explanations	10
    8.	List of std() variables used with explanations	10
    
VII.	Running the Script and Key Decision Points	11

    1.	System Configuration	11
    2.	Executing the Script	12
    3.	Messages Typed to the Screen	12
    4.	Downloading and Extracting Files	13
    5.	Transformation of Data	13
    6.	Tidy Data Set Results	13
    7.	The Tidiness of the Data Set	14
    
VIII.	References	15

Appendix A	16

    Coursera Project Description	16
    
Appendix B	17

    Original Data Set Description	17
    Feature Selection Information	19
    
Appendix C	20

    How the Original Data Knits Together	20

## I.	Introduction
The course “Getting and Cleaning Data” offered by Johns Hopkins University through Coursera has a culminating project. The student must complete an R script that performs data transformation and creates a text file. Part of the project offering is this code book, along with the script, a readme file and the data file.

## II.	Documentation Conventions

References to section headings within this document are in double quotes.

__File names, directories__ and __URLs__ use a __bold__ Verdana sans serif font.

Screen text uses the Lucida Console <kbd>monospaced</kbd> serif font.

## III.	Assumptions about the Audience
This project code book assumes that the reader has a basic working knowledge of R; using packages; sourcing script files and executing scripts; importing data; organizing data in data frames; doing basic mathematical calculations, such as mean or standard deviation; and writing out data to a text file. Understanding these concepts is helpful when reading this code book, the R script, custom readme and the tidy data set.

This code book assumes the reader only has access to __CodeBook.md__, __run_analysis.R__ and __README.md__. The project includes the tidy data set generated by the script, __gcd_tidy_data_set.txt__. The code book also assumes the user has access to the Internet with a connection speed sufficient to download a 58 MB file. The script downloads all pertinent original data and descriptive files from the internet and extracts them before beginning the data transformation process.

## IV.	Project Requirements

### 1.	List of Deliverables:

  1.	GitHub repository for this Johns Hopkins project, https://github.com/sdbj2063/gcd
  2.	Link to the Github repo
  3.	__gcd_tidy_data_set.txt__ tidy data set in the GitHub repo
  4.	__CodeBook.md__ code book in the GitHub repo
  5.	__README.md__ in the GitHub repo
  6.	__run_analysis.R__ in the GitHub repo. The file should have limited comments and perform the 
  required data analysis requirements.

### 2.	Data Analysis Requirements:
An R script titled __run_analysis.R__ must perform the following actions:

  1.	Merge the test and training data sets into one data set.
  2.	Extract the measurements on the mean and standard deviation for each measurement.
  3.	Use descriptive activity names for the activities.
  4.	Use human-readable descriptive names for the variables.
  5.	From the data set created following steps 1-4, create a second, independent tidy data set with
    the average of each variable for each activity and each subject.

I interpreted #5 to be the mean for each variable containing "mean()" and "std()" in the name, grouped by subject and activity. For more information about the decision process in choosing the variables, please see sections VI.2 and VI.3, “Processing Decisions,” “Choosing Variable for Mean and Standard Deviation Calculations” and “Excluded Variables with ‘mean’ in the Name.”

“Appendix A” contains the Johns Hopkins project description.

## V.	Original Data Sources

### 1.	URLs

This project utilizes the code book and data at the following URLs:

1)	The original project description:
  http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones

2)	The original data for that project:
  https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip

“Appendix B” contains the original project and data description.

### 2.	Licensing Statement from Original Development Team

Use of this dataset in publications must be acknowledged by referencing the following publication [1] 

[1] Davide Anguita, Alessandro Ghio, Luca Oneto, Xavier Parra and Jorge L. Reyes-Ortiz. Human Activity Recognition on Smartphones using a Multiclass Hardware-Friendly Support Vector Machine. International Workshop of Ambient Assisted Living (IWAAL 2012). Vitoria-Gasteiz, Spain. Dec 2012.

This dataset is distributed AS-IS and no responsibility implied or explicit can be addressed to the authors or their institutions for its use or misuse. Any commercial use is prohibited.

Jorge L. Reyes-Ortiz, Alessandro Ghio, Luca Oneto, Davide Anguita. November 2012.

### 3.	Description of Data from the Original Project

The original researchers derived the data from recording 30 subjects performing a variety of activities (WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, LAYING) while wearing a Samsung Galaxy II smartphone. The original experiment designers randomly divided the subjects into two groups, 70% for training data and 30% for test data. The volunteers had an age range of 19 to 48. Using the phones' embedded accelerometer and gyroscope, the research team recorded linear acceleration and angular velocity on the X, Y and Z axis at a rate of 50Hz. Included in the acceleration data are gravitational and body motion components. By utilizing the time and frequency domains in the 128 readings for each activity window, the researchers calculated 561 variables of data, including mean and standard deviation.

“Appendix B” contains a more detailed explanation of the data and process.

The data pertaining to this Johns Hopkins project is a collection of 561 attributes of time series data. Each row of data pertains to one subject and one of six activities. There are multiple collections of data points for each subject and activity. 

### 4.	Description of Data Sets

The zipped file includes several data sets that the system extracts into subdirectories in the working directory:

  __/UCI HAR Dataset__

  __/UCI HAR Dataset/test__

  __/UCI HAR Dataset/train__

The data files used for this project consist of nine test subjects, __X_test.txt__ and __y_test.txt__, and 21 evaluated subjects, __X_train.txt__ and __y_train.txt__. The "X" data files contain the calculated data for the variables collected. The "y" data files contain a column with an activity code for each row of data in the corresponding "X" data file. The __subject_test.txt__ and __subject_train.txt__ data files contain a column with the subject id for each row of data in the corresponding "X" data files.

The "X" data sets have separate column names contained in features.txt.

Activity codes in the "X" data sets match one of the six character label names contained in __activity_labels.txt__.

The fully expanded zip file also provides raw data files in subdirectories:

  __/UCI HAR Dataset/test/InertialSignals__
  
  __/UCI HAR Dataset/train/InertialSignals__
    
They are not necessary for the purpose of this Johns Hopkins project.

### 5.	How Data Knits Together

The original source data knits together in a Lego block pattern, with rectangles of different sizes forming to create one large rectangle. The diagram in “Appendix C” illustrates how the various data files knit together to form a cohesive data set. It also shows the primary phases in processing the data to reach the tidy data set.


### 6.	Data Files Used with Definitions

The project requires the following data files included in the zipped file downloaded during the script's running process:

Filename	| Description
--------  | ------------
__features.txt__	| CSV file listing all 561 variable names to be used for column names.
__activity_labels.txt__	| CSV file listing the six activity codes with their activity names.
__train/X_train.txt__	| CSV file with 561 variables of data for the training subjects.
__train/y_train.txt__	| CSV file with the activity codes for the X_train.txt data.
__train/subject_train.txt__	| CSV file with the subject ids for the training subjects.
__test/X_test.txt__	| CSV file with 561 variables of data for the test subjects.
__test/y_test.txt__	| CSV file with the activity codes for the X_test.txt data.
__test/subject_test.txt__	| CSV file with the subject ids for the test subjects.


## VI.	Processing Decisions

Completing the project data transformations required making several key decisions, including what commands to use, which variables to select, how to name the variables and researching the background of gyroscopes and accelerometers within the context of mobile phones.

### 1.	R Language Libraries

I used two libraries, "utils" and "reshape2," the latter of which the lesson videos covered. To address the mean calculations I used "melt" and "dcast" from the "reshape2" library.

I removed variables as they became obsolete, which improved performance.

### 2.	Choosing Variables for Mean and Standard Deviation Calculations
The Johns Hopkins project required students to calculate the mean() for variables pertaining to the baseline calculations for mean and standard deviation on the raw data sets.

The original data sets had 561 variables with X, Y, and Z measurements for location in space. To meet the project requirements for mean and standard deviation, I selected 33 variables with "mean()" and 33 variables with "std()" in the names.

### 3.	Excluded Variables with “mean” in the Name

A key assumption I made in choosing what variables to use is that the Johns Hopkins professor would want symmetrical results for students to review one another. In other words, it made sense that when reviewing variable names, I identified an equal number of variables with “std()” and “mean().”

One noticeable aspect of the list of 561 variables is that the original researchers made many baseline calculations on the raw data. In addition to mean and standard deviation, they calculated the median absolute deviation (mad()), the largest and smallest values in the array (max() and min()), the signal magnitude area (sma()), and interquartile range (iqr()), among others, for the major variable groups. 

Then they calculated the meanFreq().  According to the original data project file features_info.txt, "meanFreq(): Weighted average of the frequency components to obtain a mean frequency."  The researchers did not explain why they calculated the mean on frequency but not complete the other baseline calculations on frequency, such as standard deviation. This lead me to believe that the meanFreq() calculations were secondary calculations. Furthermore, including these would unbalance the tidy data set as a whole. 

The excluded “mean” variables for this Johns Hopkins project are below:

* fBodyAcc-meanFreq()-X
* fBodyAcc-meanFreq()-Y
* fBodyAcc-meanFreq()-Z
* fBodyAccJerk-meanFreq()-X
* fBodyAccJerk-meanFreq()-Y
* fBodyAccJerk-meanFreq()-Z
* fBodyGyro-meanFreq()-X
* fBodyGyro-meanFreq()-Y
* fBodyGyro-meanFreq()-Z
* FbodyBodyAccJerkMag-meanFreq()
* fBodyBodyGyroMag-meanFreq()
* fBodyBodyGyroJerkMag-meanFreq()

Seven angle variables contained "mean." In this context, according to features_info.txt, "angle(): Angle between to(sp) vectors." This is not a baseline calculation but a relationship between two data points, one of which is a mean. As such, this is a secondary calculation and does not meet the Johns Hopkins project criteria. The rejected variables follow:

angle(tBodyAccMean,gravity)
angle(tBodyAccJerkMean),gravityMean
angle(tBodyGyroMean,gravityMean)
angle(tBodyGyroJerkMean,gravityMean)
angle(X,gravityMean)
angle(Y,gravityMean)
angle(Z,gravityMean)

### 4.	Background on Gyroscopes, Accelerometers and Original Data

The gyroscope determines orientation in 3D space, while the accelerometer measures non-gravitational acceleration. The gyroscope maintains a position on a 3-axial plane, using gravity to determine which way is down. The accelerometer captures vibrations and generates current signals when the device moves; based upon those signals it calculates acceleration.  Ref 1, 2

The original researchers used "low pass Butterworth filter with a corner frequency of 0.3 Hz" to separate the acceleration signal into body and gravity figures.  The original development team obtained the frequency domain signals by applying Fast Fourier Transform (FFT) to variables.  Ref 3

Using time and the “body linear acceleration and angular velocity,” researchers calculated Jerk signals. Finally, using the Euclidean norm, researchers calculated the magnitude of the XYZ values. Ref 3

The _X, _Y and _Z values in the data indicate the axial measurements. Ref 3. X and Y are planar coordinates, and Z is the altitude, or depth.

### 5.	Human-readable Variable Names

What constitutes a human-readable descriptive name is a question of personal experience. In database development, administrators often use standard abbreviations to represent key database concepts, such as “tbl” for table or “qry” for query. They also use underscores to separate words that are parts of names to make them more readable.
In the R language development environment, most commands or functions have multiple words to make up one function name. Each word begins with a capital letter to ease readability.

I chose to expand key abbreviations to a complete word, capitalize the first letter of each word and substitute underscore for special characters. Some of the variable names are long, but they are more understandable. Word substitutions included the following:

•	"t" at the beginning of the variable name became "Time."
•	"f" at the beginning of the variable name became "Freq" for frequency.
•	"Acc" became "Acceleration."
•	"Gyro" became "Gyroscope."
•	"Mag" became "Magnitude."

I found two common patterns in the system, "-X()-" and "-X()" where X was either "mean" or "std." Substituting "_" for the punctuation in those four parameters became the final step in the conversion process. 

### 6.	Variable Key Words and Their Meanings

I contacted the original developers and asked why they used the phrase “BodyBody” in some variable names. I did not receive a reply.
Key Word Substitute	Meaning	Original Variable Tag
Time	Time series data.	t
Freq	Frequency domain signals calculated.	f
Body	Body motion component from sensor acceleration signal	Body
BodyBody	Body motion component. The original developers did not provide an explanation for this keyword combination. 	BodyBody
Acceleration	Linear acceleration.	Acc
Jerk	Rate of change of acceleration. 	Jerk
Gyroscope	Angular velocity. 	Gyro
Gravity	Gravitational motion component from sensor acceleration signal.	Gravity
Magnitude	How far the quantity differs from zero.	Mag

References 3, 4, 5

7.	List of mean() variables used with explanations

The following variables contain the mean value of the mean() variables grouped by subject and activity.
The table below lists the time measurements.

Variable Name | Explanation
------------- | ------------
TimeBodyAcceleration_mean_X, _Y, _Z	| Body acceleration signal.
TimeGravityAcceleration_mean_X, _Y, _Z	  | Gravity acceleration signal
TimeBodyAccelerationJerk_mean_X, _Y, _Z	| Body acceleration jerk measurement
TimeBodyGyroscope_mean_X, _Y, _Z	| Body gyroscope baseline measurement
TimeBodyGyroscopeJerk_mean_X, _Y, _Z	| Body angular jerk velocity
TimeBodyAccelerationMagnitude_mean	| Magnitude of its measurement
TimeGravityAccelerationMagnitude_mean	| Magnitude of its measurement
TimeBodyAccelerationJerkMagnitude_mean	| Magnitude of its measurement
TimeBodyGyroscopeMagnitude_mean	| Magnitude of its measurement
TimeBodyGyroscopeJerkMagnitude_mean	| Magnitude of its measurement

The following variables are frequency counterpart measurements to the time measurements above. The original development team obtained the frequency domain signals by applying Fast Fourier Transform (FFT) to variables.

* FreqBodyAcceleration_mean_X, _Y, _Z
* FreqBodyAccelerationJerk_mean_X, _Y, _Z
* FreqBodyGyroscope_mean_X, _Y, _Z
* FreqBodyAccelerationMagnitude_mean
* FreqBodyBodyAccelerationJerkMagnitude_mean
* FreqBodyBodyGyroscopeMagnitude_mean
* FreqBodyBodyGyroscopeJerkMagnitude_mean

8.	List of std() variables used with explanations
The following variables contain the mean value of the standard deviation--std()--variables grouped by subject and activity.

The table below lists the time measurements.


Variable Name | Explanation
------------- | ------------
TimeBodyAcceleration_std_X, _Y, _Z | Body acceleration signal.
TimeGravityAcceleration_std_X, _Y, _Z |	Gravity acceleration signal
TimeBodyAccelerationJerk_std_X, _Y, _Z	| Body acceleration jerk measurement
TimeBodyGyroscope_std_X, _Y, _Z	| Body gyroscope baseline measurement
TimeBodyGyroscopeJerk_std_X, _Y, _Z	| Body angular jerk velocity
TimeBodyAccelerationMagnitude_std	| Magnitude of its measurement
TimeGravityAccelerationMagnitude_std	| Magnitude of its measurement
TimeBodyAccelerationJerkMagnitude_std	| Magnitude of its measurement
TimeBodyGyroscopeMagnitude_std	| Magnitude of its measurement
TimeBodyGyroscopeJerkMagnitude_std	| Magnitude of its measurement

The following variables are frequency counterpart measurements to the time measurements above. The original development team obtained the frequency domain signals by applying Fast Fourier Transform (FFT) to variables.
* FreqBodyAcceleration_std_X, _Y, _Z
* FreqBodyAccelerationJerk_std_X, _Y, _Z
* FreqBodyGyroscope_std_X, _Y, _Z
* FreqBodyAccelerationMagnitude_std
* FreqBodyBodyAccelerationJerkMagnitude_std
* FreqBodyBodyGyroscopeMagnitude_std
* FreqBodyBodyGyroscopeJerkMagnitude_std





